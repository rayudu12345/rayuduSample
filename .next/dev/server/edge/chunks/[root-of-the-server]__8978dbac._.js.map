{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\nexport function middleware(request: NextRequest) {\n  const pathname = request.nextUrl.pathname;\n\n  // Log incoming requests to API\n  if (pathname.startsWith('/api/')) {\n    console.log(`[${new Date().toISOString()}] ${request.method} ${pathname}`);\n  }\n\n  // Protect OTP page - require auth token\n  if (pathname.startsWith('/otp')) {\n    const token = request.cookies.get('authToken')?.value;\n    \n    if (!token) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n  }\n\n  // Add security headers\n  const response = NextResponse.next();\n  response.headers.set('X-Content-Type-Options', 'nosniff');\n  response.headers.set('X-Frame-Options', 'DENY');\n  response.headers.set('X-XSS-Protection', '1; mode=block');\n\n  return response;\n}\n\nexport const config = {\n  matcher: [\n    '/api/:path*',\n    '/otp/:path*',\n  ],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,+BAA+B;IAC/B,IAAI,SAAS,UAAU,CAAC,UAAU;QAChC,QAAQ,GAAG,CAAC,CAAC,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,EAAE,EAAE,QAAQ,MAAM,CAAC,CAAC,EAAE,UAAU;IAC3E;IAEA,wCAAwC;IACxC,IAAI,SAAS,UAAU,CAAC,SAAS;QAC/B,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc;QAEhD,IAAI,CAAC,OAAO;YACV,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,uBAAuB;IACvB,MAAM,WAAW,gMAAY,CAAC,IAAI;IAClC,SAAS,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC/C,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACxC,SAAS,OAAO,CAAC,GAAG,CAAC,oBAAoB;IAEzC,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;KACD;AACH"}}]
}